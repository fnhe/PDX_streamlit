source /home/hef/Tools/miniconda3/etc/profile.d/conda.sh;conda activate py2
/bin/rm -rf /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/strelka/manta/runWorkflow.py;configManta.py --normalBam=/project/gccri/CPRIT_PDX/hef_folder/0.raw_data/DNAseq_bam.final/1913_Germline_WES.dedupped.realigned.recal.bam --tumorBam=/project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/2.gatk/1913-A_PDX_WES.dedupped.realigned.recal.bam --referenceFasta=/home/hef/Data/hg38/resources_broad_hg38_v0/Homo_sapiens_assembly38.fasta --exome --runDir=/project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/strelka/manta
/project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/strelka/manta/runWorkflow.py -j 4 -g 8 >>/project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/strelka_run.log 2>&1
/bin/rm -rf /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/strelka/runWorkflow.py;configureStrelkaSomaticWorkflow.py --normalBam=/project/gccri/CPRIT_PDX/hef_folder/0.raw_data/DNAseq_bam.final/1913_Germline_WES.dedupped.realigned.recal.bam --tumorBam=/project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/2.gatk/1913-A_PDX_WES.dedupped.realigned.recal.bam --referenceFasta=/home/hef/Data/hg38/resources_broad_hg38_v0/Homo_sapiens_assembly38.fasta --callMemMb=2048 --exome --runDir=/project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/strelka --indelCandidates=/project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/strelka/manta/results/variants/candidateSmallIndels.vcf.gz >/project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/strelka_run.log 2>&1
/project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/strelka/runWorkflow.py -m local -j 4 -g 8 >>/project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/strelka_run.log 2>&1
less /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/strelka/results/variants/somatic.snvs.vcf.gz|bcftools view -i 'FILTER="PASS"'>/project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/strelka/strelka.snvs.vcf;less /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/strelka/results/variants/somatic.indels.vcf.gz|bcftools view -i 'FILTER="PASS"'>/project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/strelka/strelka.indels.vcf
picard MergeVcfs I=/project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/strelka/results/variants/somatic.snvs.vcf.gz I=/project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/strelka/results/variants/somatic.indels.vcf.gz O=/project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/strelka/somatic.merge.vcf
bcftools view -f PASS /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/strelka/somatic.merge.vcf >  /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/strelka/somatic.merge.filter.vcf
vcf-genotype-annotator /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/strelka/somatic.merge.filter.vcf TUMOR 0/1 -o /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/1913-A_PDX_WES.strelka.vcf
samtools mpileup -q 1 -Q 13 -f /home/hef/Data/hg38/resources_broad_hg38_v0/Homo_sapiens_assembly38.fasta -b /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/varscan/varscan_bam.ls|varscan somatic - /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/varscan/varscan.out.som --mpileup 1 --output-vcf 1 --output-snp /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/varscan/varscan_snp --output-indel /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/varscan/varscan_indel > /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/varscan_run.log 2>&1
varscan processSomatic /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/varscan/varscan_indel.vcf
varscan processSomatic /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/varscan/varscan_snp.vcf
varscan somaticFilter /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/varscan/varscan_snp.Somatic.hc.vcf  --indel-file /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/varscan/varscan_indel.Somatic.hc.vcf --output-file /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/varscan/varscan.filtered.snv.vcf
varscan somaticFilter /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/varscan/varscan_indel.Somatic.hc.vcf --output-file /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/varscan/varscan.filtered.indel.vcf
bgzip /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/varscan/varscan.filtered.indel.vcf; tabix -p vcf /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/varscan/varscan.filtered.indel.vcf.gz
bgzip /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/varscan/varscan.filtered.snv.vcf; tabix -p vcf /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/varscan/varscan.filtered.snv.vcf.gz
bcftools concat -a /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/varscan/varscan.filtered.indel.vcf.gz /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/varscan/varscan.filtered.snv.vcf.gz > /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/varscan/varscan.filtered.merge.vcf
perl /home/hef/Tools/fpfilter.pl --vcf-file  /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/varscan/varscan.filtered.merge.vcf --bam-file /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/2.gatk/1913-A_PDX_WES.dedupped.realigned.recal.bam  --sample TUMOR --reference /home/hef/Data/hg38/resources_broad_hg38_v0/Homo_sapiens_assembly38.fasta --output /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/varscan/1913-A_PDX_WES.varscan.result.vcf
bcftools view -f PASS /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/varscan/1913-A_PDX_WES.varscan.result.vcf > /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/1913-A_PDX_WES.varscan.vcf
gatk Mutect2 -R /home/hef/Data/hg38/resources_broad_hg38_v0/Homo_sapiens_assembly38.fasta -L /home/hef/Data/files_liding/mutect/wgs_calling_regions.hg38.interval_list -I /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/2.gatk/1913-A_PDX_WES.dedupped.realigned.recal.bam -tumor 1913-A_PDX_WES -I /project/gccri/CPRIT_PDX/hef_folder/0.raw_data/DNAseq_bam.final/1913_Germline_WES.dedupped.realigned.recal.bam -normal 1913_Germline_WES --germline-resource /home/hef/Data/files_liding/mutect/af-only-gnomad.hg38.vcf.gz --panel-of-normals /home/hef/Data/files_liding/mutect/gatk4_mutect2_4136_pon.vcf.gz -O /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/mutect/mutect.raw.vcf > /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/mutect_run.log 2>&1
gatk FilterMutectCalls -R /home/hef/Data/hg38/resources_broad_hg38_v0/Homo_sapiens_assembly38.fasta -V /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/mutect/mutect.raw.vcf -O /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/mutect/mutect.filter.vcf
gatk SelectVariants -R /home/hef/Data/hg38/resources_broad_hg38_v0/Homo_sapiens_assembly38.fasta -V /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/mutect/mutect.filter.vcf -O /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/mutect/mutect.raw.snp.vcf --select-type-to-include SNP --select-type-to-include MNP;gatk SelectVariants -R /home/hef/Data/hg38/resources_broad_hg38_v0/Homo_sapiens_assembly38.fasta -V /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/mutect/mutect.filter.vcf -O /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/mutect/mutect.raw.indel.vcf --select-type-to-include INDEL
less /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/mutect/mutect.raw.snp.vcf|bcftools view -i 'FILTER="PASS"'>/project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/mutect/mutect.fil.snp.vcf
less /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/mutect/mutect.raw.indel.vcf|bcftools view -i 'FILTER="PASS"'>/project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/mutect/mutect.fil.indel.vcf
picard MergeVcfs I=/project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/mutect/mutect.fil.snp.vcf I=/project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/mutect/mutect.fil.indel.vcf O=/project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/1913-A_PDX_WES.mutect.vcf
pindel -T 4 -f /home/hef/Data/hg38/resources_broad_hg38_v0/Homo_sapiens_assembly38.fasta -i /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/pindel/pindel.config --exclude /home/hef/Data/hg38/hg38.centromere_telomere.bed -o /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/pindel/pindel_raw >/project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/pindel_run.log 2>&1
cat /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/pindel/pindel*_D /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/pindel/pindel*_SI |grep ChrID > /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/pindel/all.header
perl /home/hef/Tools/somaticwrapper-master/pindel_filter.v0.5.pl /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/pindel/pindel.filter.config
vt normalize /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/pindel/all.header.CvgVafStrand_pass.Homopolymer_pass.vcf -r /home/hef/Data/hg38/resources_broad_hg38_v0/Homo_sapiens_assembly38.fasta -o /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/pindel/1913-A_PDX_WES.indel.filter.output.norm.vcf -n
perl /home/hef/2.project/1.PDX/4.DNAseq_mutation/1.somatic/1.paired/add_pindel_flag.pl /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/pindel/1913-A_PDX_WES.indel.filter.output.norm.vcf > /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/pindel/1913-A_PDX_WES.indel.filter.output.norm.flag.vcf
conda deactivate
vt normalize /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/pindel/all.header.CvgVafStrand_pass.Homopolymer_pass.vcf -r /home/hef/Data/hg38/resources_broad_hg38_v0/Homo_sapiens_assembly38.fasta -o /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/pindel/1913-A_PDX_WES.indel.filter.output.norm.vcf -n
perl /home/hef/2.project/1.PDX/4.DNAseq_mutation/1.somatic/1.paired/add_pindel_flag.pl /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/pindel/1913-A_PDX_WES.indel.filter.output.norm.vcf > /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/pindel/1913-A_PDX_WES.indel.filter.output.norm.flag.vcf
bcftools view -f PASS /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/pindel/1913-A_PDX_WES.indel.filter.output.norm.flag.vcf > /project/gccri/CPRIT_PDX/hef_folder/9.re_sequencing.20230606/3.snv/tumor_normal/1913-A_PDX_WES/1913-A_PDX_WES.pindel.vcf
